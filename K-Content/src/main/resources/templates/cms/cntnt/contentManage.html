<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>CSS Grid</title>
	<link rel="stylesheet" href="/css/content/default.css">
    <link rel="stylesheet" href="/css/content/ui-ie.css">
    <link rel="stylesheet" href="/css/content/cntntManage.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0"/>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet">
	<script	src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.min.js"></script>
</head>
<body>
<input type="checkbox" id="modal-switch">
<label for="modal-switch">
    <span>모달 열고 닫기</span>
</label>

<div class="page">
    <header class="header">
        <h1 class="website-title">k-spectrum</h1>
        <form class="search-form" id="search-form">
            <input type="search" id="search-input">
            <input id="search-button" onclick="searchButton()" type="button"  value="찾기">
        </form>
    </header>

    <aside class="secondary secondary-a" th:insert="~{/include/admin-sideBar :: adminSideBar}">
    </aside>
	    
    <section class="primary">
        <ul class="card-list" id="card-list">

        </ul>
        
        <div class="position-relative">
		    <nav aria-label="Page navigation" class="d-flex justify-content-center">
				<ul class="pagination">
					<li class="page-item" th:if="${nowPageBlock>1}">
						<a class="page-link prepage" aria-label="Previous">
							<span aria-hidden="true">&laquo;</span>
						</a>
					</li>
		
					<li class="page-item" th:each="i: ${#numbers.sequence(startPage, endPage)}" th:classappend="${i==nowPage}?active" th:id="${i}">
						<a class="page-link selpage" th:data-selpage="${i}" th:text="${i}"></a>
					</li>
		
					<li class="page-item" th:if="${nowPageBlock<totalPageBlock}">
						<a class="page-link nexpage" aria-label="Next">
							<span aria-hidden="true">&raquo;</span>
						</a>
					</li>
				</ul>
			</nav>
			
			<div class="col-2 position-absolute top-0 end-0">
	            <a class="btn border" href="content/new">생성</a>
	            <a class="btn border" type="button" href="recomm">추천</a>
	        </div>
        </div>
    </section>


    <!-- </div> -->

    <footer class="footer">
        
        Lorem ipsum dolor sit amet consectetur.
    </footer>


</div>


<script src="/vendor/jquery/jquery.min.js"></script>
<script th:src="@{/js/cntnt/cntntManagement.js}" defer></script>
<script type="text/javascript" th:inline="javascript">
$(document).ready(function() {
	let page = "[[${session.page}]]";

	if(page == 'null') {
		page = 1;
	}
	
	$.ajax({
	    url: '/cs/contents/' + page, 
		type: 'GET',
		data : {'page' : page},
	    success: function (contentList) {
	        const element = document.getElementById('card-list');
	
	        for (i = 0; i < contentList.length; i++) {
	            inHtml = `
	            <li class="card-item" id="card-item" onclick="cntntDetail(${contentList[i].cntntId})">
	                <figure class="card-image"style="background-image: url(${contentList[i].cntntThumnail})">
	                    <img src=${contentList[i].cntntThumnail} >
	                </figure>
	                <div class="card-desc">
	                   ${contentList[i].cntntTitle}
	                </div>
	            </li>`;
	            element.insertAdjacentHTML("afterbegin", inHtml);
	
	        }
	        
	    }, error: function (error) {
	        console.error('에러 발생: ', error);
	    }
	})
	
	$(".selpage").click(function() {
		var nowPage = $(this).data("selpage");
		 
		$.ajax({
			url: "/cs/contents/" + nowPage,
			method: "get",
			data: {page : nowPage},
			success: function (contentList) {
		        const element = $('#card-list');
		        element.empty();
 		        
		        for (i = 0; i < contentList.length; i++) {
		            inHtml = `
		            <li class="card-item" id="card-item" onclick="cntntDetail(${contentList[i].cntntId})">
		                <figure class="card-image"style="background-image: url(${contentList[i].cntntThumnail})">
		                    <img src=${contentList[i].cntntThumnail} >
		                </figure>
		                <div class="card-desc">
		                   ${contentList[i].cntntTitle}
		                </div>
		            </li>`;
		            element.append(inHtml);
		        }
		        $(".page-item").removeClass("active");
		        $("#" + nowPage).addClass("active");

		    }, error: function (error) {
		        console.error('에러 발생: ', error);
		    }
		})
	})
	
	$(".prepage").click(function() {
		var prePage = $(this).data("prepage") - 1;
		
		$.ajax({
			url : "/cs/contents/" + prePage,
			method: "get",
			success: function (contentList) {
		        const element = document.getElementById('card-list');
		
		        for (i = 0; i < contentList.length; i++) {
		            inHtml = `
		            <li class="card-item" id="card-item" onclick="cntntDetail(${contentList[i].cntntId})">
		                <figure class="card-image"style="background-image: url(${contentList[i].cntntThumnail})">
		                    <img src=${contentList[i].cntntThumnail} >
		                </figure>
		                <div class="card-desc">
		                   ${contentList[i].cntntTitle}
		                </div>
		            </li>`;
		            element.insertAdjacentHTML("afterbegin", inHtml);
		        }
		        
		    }, error: function (error) {
		        console.error('에러 발생: ', error);
		    }
		})
	})
	
	$(".nexpage").click(function() {
		var nexPage = $(this).data("nexpage") + 1;
		
		$.ajax({
			url : "/cs/contents/" + prePage,
			method: "get",
			seccess: function(contentList) {
				console.log(contentList);
			}
		})
	})
});

</script>


</body>

</html>
