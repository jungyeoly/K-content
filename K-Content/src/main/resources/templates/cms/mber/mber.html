<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:sec="http://www.thymeleaf.org/extras/spring-security" lang="ko">
<head>
<th:block th:replace="~{/include/new-admin-head :: newAdminHead}"></th:block>

<style>
table {
	border-collapse: collapse
}

*, ::after, ::before {
	box-sizing: border-box
}

.card {
	margin-bottom: 1.25em;
}

.card .card-header {
	position: relative;
}

.card .card-header strong {
	display: block;
}

.card .card-header small {
	float: left;
}

.card .card-header .card-actions {
	right: 0;
	top: .75rem;
	position: absolute;
}

.card-footer.bg-white.br-0.pl-5.pr-5.pt-0.pb-5 {
	padding-bottom: 1.5em !important;
	padding-left: 1em !important;
	padding-right: 1em !important;
}

.order-table {
	position: relative;
}

.order-table:after, .order-table:before {
	content: "";
	position: absolute;
	top: 0px;
	height: 37px;
	width: 10px;
	background: #e8e9ef;
}

.order-table:after {
	right: -1px;
}

.order-table:before {
	left: -1px;
}

.order-table tr th {
	background: #e8e9ef;
}

.order-table tr td:last-child, .order-table tr th:last-child {
	text-align: center;
}

.order-table tr:last-child td {
	border: none;
}

.order-table .badge {
	color: white;
	padding: 10px;
	font-weight: normal;
}

.order-table .badge-complete {
	background: #00c292;
}

.order-table .badge-pending {
	background: #fb9678;
}
/* Stats Table */
.table-stats table {
	font-family: 'Open Sans';
}

.table-stats table th, .table-stats table td {
	border: none;
	border-bottom: 1px solid #e8e9ef;
	color: #868e96;
	font-size: 12px;
	font-weight: normal;
	padding: .75em 1.25em;
	text-align: center;
	white-space: nowrap;
}

.table-stats table th img, .table-stats table td img {
	margin-right: 10px;
	max-width: 45px;
}

.table-stats table th .name, .table-stats table td .name {
	color: #343a40;
	font-size: 14px;
}

.table-stats table td {
	color: #343a40;
	font-size: 10px;
	font-weight: 600;
	vertical-align: middle;
}

/* Timeline */
</style>
</head>
<body>
	<header th:insert="~{/include/admin-body-header :: adminNavBar}"></header>
	<div class="content">
		<div class="animated fadeIn">
			<div class="row">
				<div class="col-lg-12">
					<div class="card">
						<div class="card-header">
							<strong class="card-title">사용자 관리</strong>
						</div>
						<div class="table-stats order-table ov-h">
							<table class="table">
								<thead>
									<tr>
										<th class="serial">#</th>
										<th>계정구분</th>
										<th>아이디</th>
										<th>이름</th>
										<th>이메일</th>
										<th>성별</th>
										<th>생년월일</th>
										<th>전화번호</th>
										<th>가입일시</th>
										<th>수정일시</th>
										<th>상태</th>
										<th>상태수정</th>
										<!--<th>ID</th>-->
										<!--<th>Product</th>-->
									</tr>
								</thead>
								<tbody>
									<tr th:each="mber, rowStat : ${mber}">
										<td th:text="${rowStat.index + 1}"></td>
										<td th:text="${mber.mberRole}"></td>
										<td th:text="${mber.mberId}"></td>
										<td th:text="${mber.mberName}"></td>
										<td th:text="${mber.mberEmail}"></td>
										<td th:text="${mber.mberGenderCode}"></td>
										<td th:if="${mber.mberBirth} == null">-</td>
										<td th:unless="${mber.mberBirth} == null" th:text="${mber.mberBirth}"></td>
										<td th:if="${mber.mberPhone} == null">-</td>
										<td th:unless="${mber.mberPhone} == null" th:text="${mber.mberPhone}"></td>
										<td th:text="${mber.mberRegistDate}"></td>
										<td th:if="${mber.mberUpdateDate} == null">-</td>
										<td th:unless="${mber.mberUpdateDate} == null"
											th:text="${mber.mberUpdateDate}"></td>
										<td th:text="${mber.mberStat}"></td>
										<td>
											<button class="badge badge-pending"
												th:if="${mber.mberStat == '활성화'}" th:data-mber-id="${mber.mberId}"
												onclick="changeStatus(this.getAttribute('data-mber-id'), 'C0201')">비활성화</button>
											<button class="badge badge-complete"
												th:if="${mber.mberStat == '비활성화'}"    th:data-mber-id="${mber.mberId}"
												onclick="changeStatus(this.getAttribute('data-mber-id'), 'C0202')">활성화</button>
										</td>
									</tr>
								</tbody>
							</table>
							<!-- 페이징 처리 -->
							<!--     <div class="pagination">
                                <ul>
                                    <li th:if="${pageInfo.pageNum > 1}">
                                        <a th:href="@{/manager/user_manager(pageNum=${pageInfo.pageNum - 1})}" th:text="'&laquo;'"></a>
                                    </li>
                                    <li th:each="page : ${#numbers.sequence(1, pageInfo.totalPages)}" th:class="${page == pageInfo.pageNum} ? active" th:if="${page != 0}">
                                        <a th:href="@{/manager/user_manager(pageNum=${page})}" th:text="${page}"></a>
                                    </li>
                                    <li th:if="${pageInfo.pageNum < pageInfo.totalPages}">
                                        <a th:href="@{/manager/user_manager(pageNum=${pageInfo.pageNum + 1})}" th:text="'&raquo;'"></a>
                                    </li>
                                </ul>
                            </div> -->
						</div>
						<!-- /.table-stats -->
					</div>
				</div>
				<!-- .animated -->
			</div>
			<!-- .content -->
		</div>
	</div>
<script>
function changeStatus(mberId, newStatus) {
    $.ajax({
        type: 'POST',
        url: '/mber/changestat',
        data: {
            mberId: mberId,
            newStatus: newStatus
        },
        success: function(response) {
            if (response.success) {
                // 성공적으로 상태가 변경된 경우 페이지를 새로 고침합니다.
                location.reload();
            } else {
                alert('상태 변경에 실패했습니다.');
            }
        },
        error: function() {
            alert('서버 오류로 인해 상태 변경에 실패했습니다.');
        }
    });
}
</script>
</body>
</html>